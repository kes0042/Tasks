
R version 4.0.3 (2020-10-10) -- "Bunny-Wunnies Freak Out"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin17.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[R.app GUI 1.73 (7892) x86_64-apple-darwin17.0]

[History restored from /Users/KT/.Rapp.history]

> setwd("~/Desktop/Evolution/Tasks/Task_06")
> source("http://jonsmitchell.com/code/reformatData07.R")
> source("http://jonsmitchell.com/code/simFxn.R")
> source("http://jonsmitchell.com/code/simFxn.R")
> plot(1, 1, type= "n", xlim=c(1998, 2013), ylim=c(0, 1))
> s <- apply(overallFreq, 2, function(x) lines(overallFreq [, 1], x, col= rgb (0,0,0,0,.01)))
Warning message:
In xy.coords(x, y) : NAs introduced by coercion
> rescaleFreq <- apply(overallFreq [,3:ncol(overallFreq)], 2, function(x) x-x[1])
> plot(1, 1, type= "n", xlim=c(1998, 2013), ylim=c(-0.25, 0.25))
> s <- apply(overallFreq, 2, function(x) lines(overallFreq [, 1], x, col= rgb (0,0,0,0,.01)))
Warning message:
In xy.coords(x, y) : NAs introduced by coercion
> dYear <- c()
> dAlleles <- c()
> for (i in 3:ncol(overallFreq)) {
+ dYear <- c(dYear, overallFreq [, 1]) 
+ Vec <- overallFreq [,i] 
+ Init <-overallFreq [1, i] 
+ dAlleles <- c(dAlleles, Vec - Init)}
> smoothScatter (dYear, dAlleles, colramp = Pal, nbin=100)
> simPop()
    freqa freqb Genotypes.aa Genotypes.ab
1   0.570 0.430           34           46
2   0.560 0.440           30           52
3   0.615 0.385           40           43
4   0.655 0.345           45           41
5   0.675 0.325           45           45
6   0.715 0.285           52           39
7   0.715 0.285           48           47
8   0.805 0.195           65           31
9   0.770 0.230           60           34
10  0.730 0.270           49           48
11  0.760 0.240           58           36
12  0.765 0.235           59           35
13  0.720 0.280           51           42
14  0.770 0.230           56           42
15  0.795 0.205           65           29
16  0.815 0.185           67           29
17  0.785 0.215           62           33
18  0.770 0.230           55           44
19  0.770 0.230           57           40
20  0.805 0.195           64           33
21  0.800 0.200           64           32
22  0.840 0.160           71           26
23  0.840 0.160           69           30
24  0.780 0.220           62           32
25  0.835 0.165           71           25
26  0.865 0.135           74           25
27  0.910 0.090           83           16
28  0.930 0.070           87           12
29  0.930 0.070           86           14
30  0.895 0.105           79           21
31  0.890 0.110           78           22
32  0.895 0.105           80           19
33  0.870 0.130           74           26
34  0.860 0.140           73           26
35  0.860 0.140           72           28
36  0.865 0.135           76           21
37  0.890 0.110           79           20
38  0.910 0.090           82           18
39  0.930 0.070           86           14
40  0.910 0.090           83           16
41  0.930 0.070           87           12
42  0.930 0.070           87           12
43  0.935 0.065           87           13
44  0.935 0.065           87           13
45  0.925 0.075           86           13
46  0.930 0.070           86           14
47  0.910 0.090           83           16
48  0.905 0.095           82           17
49  0.900 0.100           81           18
50  0.900 0.100           80           20
51  0.910 0.090           85           12
52  0.870 0.130           75           24
53  0.865 0.135           73           27
54  0.895 0.105           82           15
55  0.905 0.095           82           17
56  0.905 0.095           81           19
57  0.905 0.095           82           17
58  0.890 0.110           79           20
59  0.930 0.070           87           12
60  0.935 0.065           87           13
61  0.940 0.060           88           12
62  0.910 0.090           83           16
63  0.875 0.125           78           19
64  0.850 0.150           70           30
65  0.855 0.145           71           29
66  0.855 0.145           75           21
67  0.825 0.175           68           29
68  0.780 0.220           57           42
69  0.780 0.220           62           32
70  0.785 0.215           60           37
71  0.780 0.220           61           34
72  0.810 0.190           66           30
73  0.765 0.235           58           37
74  0.720 0.280           57           30
75  0.725 0.275           52           41
76  0.705 0.295           46           49
77  0.695 0.305           48           43
78  0.720 0.280           52           40
79  0.705 0.295           49           43
80  0.730 0.270           52           42
81  0.750 0.250           58           34
82  0.770 0.230           59           36
83  0.730 0.270           54           38
84  0.720 0.280           51           42
85  0.725 0.275           52           41
86  0.715 0.285           48           47
87  0.660 0.340           46           40
88  0.670 0.330           46           42
89  0.755 0.245           56           39
90  0.785 0.215           60           37
91  0.775 0.225           60           35
92  0.785 0.215           63           31
93  0.805 0.195           64           33
94  0.815 0.185           67           29
95  0.790 0.210           66           26
96  0.770 0.230           57           40
97  0.720 0.280           52           40
98  0.760 0.240           58           36
99  0.740 0.260           54           40
100 0.725 0.275           56           33
    Genotypes.bb
1             20
2             18
3             17
4             14
5             10
6              9
7              5
8              4
9              6
10             3
11             6
12             6
13             7
14             2
15             6
16             4
17             5
18             1
19             3
20             3
21             4
22             3
23             1
24             6
25             4
26             1
27             1
28             1
29             0
30             0
31             0
32             1
33             0
34             1
35             0
36             3
37             1
38             0
39             0
40             1
41             1
42             1
43             0
44             0
45             1
46             0
47             1
48             1
49             1
50             0
51             3
52             1
53             0
54             3
55             1
56             0
57             1
58             1
59             1
60             0
61             0
62             1
63             3
64             0
65             0
66             4
67             3
68             1
69             6
70             3
71             5
72             4
73             5
74            13
75             7
76             5
77             9
78             8
79             8
80             6
81             8
82             5
83             8
84             7
85             7
86             5
87            14
88            12
89             5
90             3
91             5
92             6
93             3
94             4
95             8
96             3
97             8
98             6
99             6
100           11
> smoothScatter(dYear dAlleles, colramp= Pal, nbin= 100, xlab="year", ylab="change in allele freq. since 1998")
Error: unexpected symbol in "smoothScatter(dYear dAlleles"
> simPop(100)
    freqa freqb Genotypes.aa Genotypes.ab
1   0.480 0.520           26           44
2   0.440 0.560           16           56
3   0.420 0.580           21           42
4   0.365 0.635           17           39
5   0.430 0.570           22           42
6   0.500 0.500           27           46
7   0.500 0.500           26           48
8   0.490 0.510           26           46
9   0.515 0.485           23           57
10  0.525 0.475           29           47
11  0.570 0.430           32           50
12  0.530 0.470           26           54
13  0.480 0.520           17           62
14  0.490 0.510           22           54
15  0.490 0.510           25           48
16  0.490 0.510           21           56
17  0.485 0.515           19           59
18  0.470 0.530           24           46
19  0.465 0.535           22           49
20  0.465 0.535           22           49
21  0.390 0.610           15           48
22  0.395 0.605           18           43
23  0.365 0.635           14           45
24  0.430 0.570           18           50
25  0.415 0.585           11           61
26  0.370 0.630           13           48
27  0.435 0.565           17           53
28  0.450 0.550           20           50
29  0.445 0.555           19           51
30  0.445 0.555           20           49
31  0.495 0.505           24           51
32  0.430 0.570           16           54
33  0.375 0.625           16           43
34  0.385 0.615           14           49
35  0.370 0.630           14           46
36  0.395 0.605           19           41
37  0.345 0.655           11           47
38  0.320 0.680           10           44
39  0.305 0.695           11           39
40  0.285 0.715           10           37
41  0.320 0.680            8           48
42  0.335 0.665           10           47
43  0.325 0.675           12           41
44  0.385 0.615           19           39
45  0.430 0.570           15           56
46  0.445 0.555           21           47
47  0.465 0.535           22           49
48  0.510 0.490           26           50
49  0.535 0.465           30           47
50  0.515 0.485           25           53
51  0.475 0.525           19           57
52  0.425 0.575           18           49
53  0.450 0.550           17           56
54  0.485 0.515           21           55
55  0.505 0.495           28           45
56  0.500 0.500           24           52
57  0.515 0.485           22           59
58  0.555 0.445           30           51
59  0.570 0.430           37           40
60  0.650 0.350           42           46
61  0.655 0.345           45           41
62  0.660 0.340           42           48
63  0.675 0.325           45           45
64  0.640 0.360           43           42
65  0.630 0.370           45           36
66  0.620 0.380           37           50
67  0.655 0.345           47           37
68  0.640 0.360           40           48
69  0.610 0.390           36           50
70  0.650 0.350           42           46
71  0.645 0.355           40           49
72  0.575 0.425           36           43
73  0.555 0.445           30           51
74  0.555 0.445           31           49
75  0.525 0.475           24           57
76  0.485 0.515           28           41
77  0.460 0.540           20           52
78  0.450 0.550           20           50
79  0.435 0.565           21           45
80  0.470 0.530           24           46
81  0.480 0.520           22           52
82  0.485 0.515           23           51
83  0.540 0.460           29           50
84  0.530 0.470           28           50
85  0.470 0.530           22           50
86  0.460 0.540           23           46
87  0.420 0.580           19           46
88  0.410 0.590           16           50
89  0.415 0.585           19           45
90  0.500 0.500           28           44
91  0.505 0.495           27           47
92  0.570 0.430           36           42
93  0.635 0.365           42           43
94  0.665 0.335           43           47
95  0.630 0.370           39           48
96  0.605 0.395           38           45
97  0.645 0.355           41           47
98  0.670 0.330           41           52
99  0.675 0.325           43           49
100 0.725 0.275           50           45
    Genotypes.bb
1             30
2             28
3             37
4             44
5             36
6             27
7             26
8             28
9             20
10            24
11            18
12            20
13            21
14            24
15            27
16            23
17            22
18            30
19            29
20            29
21            37
22            39
23            41
24            32
25            28
26            39
27            30
28            30
29            30
30            31
31            25
32            30
33            41
34            37
35            40
36            40
37            42
38            46
39            50
40            53
41            44
42            43
43            47
44            42
45            29
46            32
47            29
48            24
49            23
50            22
51            24
52            33
53            27
54            24
55            27
56            24
57            19
58            19
59            23
60            12
61            14
62            10
63            10
64            15
65            19
66            13
67            16
68            12
69            14
70            12
71            11
72            21
73            19
74            20
75            19
76            31
77            28
78            30
79            34
80            30
81            26
82            26
83            21
84            22
85            28
86            31
87            35
88            34
89            36
90            28
91            26
92            22
93            15
94            10
95            13
96            17
97            12
98             7
99             8
100            5
> simPop()
    freqa freqb Genotypes.aa Genotypes.ab
1   0.495 0.505           29           41
2   0.490 0.510           25           48
3   0.515 0.485           30           43
4   0.500 0.500           27           46
5   0.505 0.495           25           51
6   0.535 0.465           31           45
7   0.550 0.450           30           50
8   0.505 0.495           22           57
9   0.485 0.515           22           53
10  0.495 0.505           24           51
11  0.485 0.515           22           53
12  0.475 0.525           19           57
13  0.490 0.510           23           52
14  0.580 0.420           32           52
15  0.535 0.465           31           45
16  0.480 0.520           22           52
17  0.475 0.525           18           59
18  0.445 0.555           18           53
19  0.445 0.555           22           45
20  0.475 0.525           25           45
21  0.395 0.605           18           43
22  0.490 0.510           22           54
23  0.545 0.455           31           47
24  0.590 0.410           35           48
25  0.575 0.425           29           57
26  0.550 0.450           32           46
27  0.610 0.390           40           42
28  0.640 0.360           38           52
29  0.625 0.375           40           45
30  0.665 0.335           39           55
31  0.715 0.285           51           41
32  0.700 0.300           50           40
33  0.650 0.350           43           44
34  0.665 0.335           43           47
35  0.675 0.325           47           41
36  0.640 0.360           38           52
37  0.665 0.335           45           43
38  0.680 0.320           48           40
39  0.730 0.270           52           42
40  0.710 0.290           49           44
41  0.705 0.295           48           45
42  0.660 0.340           44           44
43  0.700 0.300           47           46
44  0.655 0.345           39           53
45  0.625 0.375           37           51
46  0.585 0.415           33           51
47  0.525 0.475           27           51
48  0.480 0.520           23           50
49  0.500 0.500           21           58
50  0.495 0.505           25           49
51  0.490 0.510           25           48
52  0.510 0.490           26           50
53  0.525 0.475           27           51
54  0.540 0.460           27           54
55  0.595 0.405           35           49
56  0.625 0.375           43           39
57  0.650 0.350           40           50
58  0.625 0.375           40           45
59  0.660 0.340           45           42
60  0.680 0.320           47           42
61  0.670 0.330           43           48
62  0.655 0.345           44           43
63  0.635 0.365           36           55
64  0.595 0.405           38           43
65  0.625 0.375           37           51
66  0.660 0.340           48           36
67  0.730 0.270           53           40
68  0.690 0.310           48           42
69  0.650 0.350           43           44
70  0.635 0.365           41           45
71  0.605 0.395           39           43
72  0.620 0.380           38           48
73  0.605 0.395           37           47
74  0.660 0.340           47           38
75  0.680 0.320           47           42
76  0.700 0.300           51           38
77  0.695 0.305           51           37
78  0.675 0.325           46           43
79  0.710 0.290           53           36
80  0.715 0.285           55           33
81  0.705 0.295           51           39
82  0.690 0.310           46           46
83  0.670 0.330           44           46
84  0.685 0.315           49           39
85  0.690 0.310           48           42
86  0.625 0.375           39           47
87  0.625 0.375           38           49
88  0.580 0.420           33           50
89  0.590 0.410           33           52
90  0.600 0.400           37           46
91  0.585 0.415           32           53
92  0.635 0.365           38           51
93  0.685 0.315           50           37
94  0.660 0.340           48           36
95  0.665 0.335           45           43
96  0.690 0.310           47           44
97  0.715 0.285           51           41
98  0.705 0.295           51           39
99  0.710 0.290           50           42
100 0.720 0.280           50           44
    Genotypes.bb
1             30
2             27
3             27
4             27
5             24
6             24
7             20
8             21
9             25
10            25
11            25
12            24
13            25
14            16
15            24
16            26
17            23
18            29
19            33
20            30
21            39
22            24
23            22
24            17
25            14
26            22
27            18
28            10
29            15
30             6
31             8
32            10
33            13
34            10
35            12
36            10
37            12
38            12
39             6
40             7
41             7
42            12
43             7
44             8
45            12
46            16
47            22
48            27
49            21
50            26
51            27
52            24
53            22
54            19
55            16
56            18
57            10
58            15
59            13
60            11
61             9
62            13
63             9
64            19
65            12
66            16
67             7
68            10
69            13
70            14
71            18
72            14
73            16
74            15
75            11
76            11
77            12
78            11
79            11
80            12
81            10
82             8
83            10
84            12
85            10
86            14
87            13
88            17
89            15
90            17
91            15
92            11
93            13
94            16
95            12
96             9
97             8
98            10
99             8
100            6
> simPop(n=100, h=1, s=0.01)
    freqa freqb Genotypes.aa Genotypes.ab
1   0.570 0.430           33           48
2   0.635 0.365           38           51
3   0.670 0.330           45           44
4   0.675 0.325           43           49
5   0.675 0.325           42           51
6   0.660 0.340           40           52
7   0.680 0.320           47           42
8   0.640 0.360           42           44
9   0.695 0.305           46           47
10  0.770 0.230           58           38
11  0.745 0.255           53           43
12  0.740 0.260           55           38
13  0.805 0.195           63           35
14  0.795 0.205           65           29
15  0.795 0.205           67           25
16  0.785 0.215           61           35
17  0.755 0.245           59           33
18  0.760 0.240           56           40
19  0.785 0.215           63           31
20  0.740 0.260           56           36
21  0.710 0.290           49           44
22  0.730 0.270           52           42
23  0.715 0.285           51           41
24  0.705 0.295           49           43
25  0.665 0.335           46           41
26  0.640 0.360           44           40
27  0.650 0.350           42           46
28  0.650 0.350           44           42
29  0.645 0.355           44           41
30  0.690 0.310           54           30
31  0.705 0.295           47           47
32  0.670 0.330           41           52
33  0.645 0.355           45           39
34  0.710 0.290           51           40
35  0.715 0.285           51           41
36  0.670 0.330           48           38
37  0.670 0.330           46           42
38  0.725 0.275           51           43
39  0.725 0.275           58           29
40  0.710 0.290           51           40
41  0.735 0.265           55           37
42  0.665 0.335           45           43
43  0.720 0.280           51           42
44  0.710 0.290           45           52
45  0.780 0.220           59           38
46  0.825 0.175           67           31
47  0.810 0.190           66           30
48  0.805 0.195           66           29
49  0.805 0.195           64           33
50  0.815 0.185           66           31
51  0.790 0.210           61           36
52  0.765 0.235           60           33
53  0.710 0.290           49           44
54  0.685 0.315           43           51
55  0.650 0.350           45           40
56  0.545 0.455           30           49
57  0.515 0.485           27           49
58  0.510 0.490           25           52
59  0.540 0.460           27           54
60  0.505 0.495           25           51
61  0.545 0.455           31           47
62  0.525 0.475           25           55
63  0.550 0.450           33           44
64  0.550 0.450           37           36
65  0.560 0.440           34           44
66  0.490 0.510           20           58
67  0.515 0.485           26           51
68  0.500 0.500           24           52
69  0.555 0.445           32           47
70  0.550 0.450           35           40
71  0.525 0.475           27           51
72  0.515 0.485           31           41
73  0.465 0.535           22           49
74  0.480 0.520           28           40
75  0.460 0.540           20           52
76  0.430 0.570           24           38
77  0.390 0.610           16           46
78  0.390 0.610           15           48
79  0.400 0.600           13           54
80  0.425 0.575           23           39
81  0.365 0.635           16           41
82  0.330 0.670           11           44
83  0.325 0.675            8           49
84  0.325 0.675           11           43
85  0.290 0.710            8           42
86  0.260 0.740            4           44
87  0.265 0.735            6           41
88  0.280 0.720            9           38
89  0.260 0.740            5           42
90  0.285 0.715            9           39
91  0.230 0.770            6           34
92  0.230 0.770            6           34
93  0.195 0.805            2           35
94  0.145 0.855            2           25
95  0.110 0.890            0           22
96  0.125 0.875            3           19
97  0.125 0.875            0           25
98  0.125 0.875            2           21
99  0.110 0.890            0           22
100 0.095 0.905            0           19
    Genotypes.bb
1             19
2             11
3             11
4              8
5              7
6              8
7             11
8             14
9              7
10             4
11             4
12             7
13             2
14             6
15             8
16             4
17             8
18             4
19             6
20             8
21             7
22             6
23             8
24             8
25            13
26            16
27            12
28            14
29            15
30            16
31             6
32             7
33            16
34             9
35             8
36            14
37            12
38             6
39            13
40             9
41             8
42            12
43             7
44             3
45             3
46             2
47             4
48             5
49             3
50             3
51             3
52             7
53             7
54             6
55            15
56            21
57            24
58            23
59            19
60            24
61            22
62            20
63            23
64            27
65            22
66            22
67            23
68            24
69            21
70            25
71            22
72            28
73            29
74            32
75            28
76            38
77            38
78            37
79            33
80            38
81            43
82            45
83            43
84            46
85            50
86            52
87            53
88            53
89            53
90            52
91            60
92            60
93            63
94            73
95            78
96            78
97            75
98            77
99            78
100           81
> x <- simPop(n=100, h=1, s=0.01)
> addFit(5, n=10, h=1, s=-0.05)
> addFit(5, n=10, h=1, s=-0.05)
> addFit
function(nruns, n = 100, ngens = 100, init_p = 0.5, h = 1, s = 0, mu = 1e-6, cpt=1.2, cLwd=2, Alpha = 1, startT = 0, rescale = F, simCol = NULL)	{
	if (is.null(simCol))	{
		Cols <- c(rgb(166/255,206/255,227/255,Alpha),rgb(31/255,120/255,180/255,Alpha),rgb(178/255,223/255,138/255,Alpha),rgb(51/255,160/255,44/255,Alpha),rgb(251/255,154/255,153/255,Alpha),rgb(227/255,26/255,28/255,Alpha),rgb(253/255,191/255,111/255,Alpha),rgb(255/255,127/255,0,Alpha),rgb(202/255,178/255,214/255,Alpha))
		Pal <- colorRampPalette(Cols, interpolate = "spline", alpha = T)
		simCol <- Pal(nruns)
	}
	else if (length(simCol) < nruns)	{
		cat("Plotting all lines using", simCol[1])
		simCol <- rep(simCol[1], nruns)
	}
# simulation runs
	for (i in 1:nruns)	{
		Pops <- simPop( n, ngens, h = h, s = s, initial_p = init_p, mu = mu)
		Time <- 1:nrow(Pops)
		Freq <- Pops[,1]
		if (rescale)	{
			Freq <- Pops[,1] - Pops[1,1]
		}
		lines(Time + startT, Freq, lwd=cLwd, col=simCol[i])
	}	

}
<bytecode: 0x7febe3444ff8>
> addFit(5, n=10, h=1, s=-0.05, startT=1996)
> addFit(nruns=50, n=100, h=1, s=0.5, ngens=18, startT=1997, simCol="gray40", rescale=TRUE)
Plotting all lines using gray40
> addFit(nruns=10, n=50, h=1, s=0.5, ngens=18, startT=1997, simCol="gray80", rescale=TRUE)
Plotting all lines using gray80
> addFit(nruns=10, n=50, h=1, s=1, ngens=18, startT=1997, simCol="gray10", rescale=TRUE)
Plotting all lines using gray10
> addFit(nruns=10, n=50, h=1, s=0, ngens=18, startT=1997, simCol="gray10", rescale=TRUE)
Plotting all lines using gray10
> smoothScatter (dYear, dAlleles, colramp = Pal, nbin=100)
> addFit(nruns=10, n=50, h=1, s=0, ngens=18, startT=1997, simCol="gray10", rescale=TRUE)
Plotting all lines using gray10
> addFit(nruns=10, n=150, h=1, s=0, ngens=18, startT=1997, simCol="gray90", rescale=TRUE)
Plotting all lines using gray90
> addFit(nruns=10, n=350, h=1, s=0, ngens=18, startT=1997, simCol="pink", rescale=TRUE)
Plotting all lines using pink
> smoothScatter (dYear, dAlleles, colramp = Pal, nbin=100)
> addFit(nruns=100, n=350, h=1, s=0, ngens=18, startT=1997, simCol="pink", rescale=TRUE)
Plotting all lines using pink
> addFit(nruns=100, n=300, h=1, s=0, ngens=18, startT=1997, simCol="pink", rescale=TRUE)
Plotting all lines using pink
> addFit(nruns=100, n=250, h=1, s=0, ngens=18, startT=1997, simCol="pink", rescale=TRUE)
Plotting all lines using pink
> smoothScatter (dYear, dAlleles, colramp = Pal, nbin=100)
> addFit(nruns=100, n=250, h=1, s=0, ngens=18, startT=1997, simCol="pink", rescale=TRUE)
Plotting all lines using pink
> plot(alleleFreqs$d_freq, alleleFreqs$d_imm, xlim=c(-.015, 0.15), xlab="overall freq. change", ylab="freq. change in subset")
> smoothScatter (dYear, dAlleles, colramp = Pal, nbin=100)
> addFit(nruns=100, n=250, h=1, s=0, ngens=18, startT=1997, simCol="pink", rescale=TRUE)
Plotting all lines using pink
> points(alleleFreqs$d_freq, alleleFreqs$d_birth, col='blue')
> 
> 